<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Sudoku Solver</title>
    <link href="Content/main.css" rel="stylesheet" type="text/css" />
    <script src="Scripts/jquery-1.6.2.js" type="text/javascript"></script>
    <script src="Scripts/knockout-2.1.0.debug.js" type="text/javascript"></script>
    <script src="Scripts/knockout.mapping-latest.js" type="text/javascript"></script>
</head>
<body>
    <div class="header">
        <h1>Sudoku Solver</h1>
    </div>
    <div class="contentContainer">
        <div class="contentLeft">
            <div id="todoPanelContainer">
                <span id="todoHeader"><strong><a href="#">To Do</a></strong></span>
                <div id="todoPanel">
                    <br />
                    . CASE 1: ID 5, square 1 cannot have any number except 1.<br />
                    ID 8, 3. grid cannot have any number except 1,2,3.
                    <br />
                    . CASE 2: ID 1, square 36 cannot have number 9.
                    <br />
                    . how about drag&drop the numbers?
                    <br />
                    . squaresLeft (numbersModel.ZeroValue count) can be improved, maybe moved to sudoku
                    details?
                    <br />
                    . checkpotential & getpotentials methods in the engine should be better!
                    <br />
                    . retrieve only unavailable ones.. - try to load availabilities as a separate thingy,
                    its very slow - is it possible to use same grid ?!
                    <br />
                    . on live server, default document doesn't work, default.html needs to be entered
                    specifically ?!
                    <br />
                    . validation; in general OK, but numpad values are ignored as well!
                    <br />
                    . improve general (content) styling! general list template? + use jQuery animations
                    ?! - IE doesnt support "inherit" - try to have more generic css items ?!
                    <br />
                    . How to serialize Read-Only properties with Json.Net?
                    <br />
                    . IEnumerable or list or ..? and any() or exists() or contains()?
                    <br />
                    . when we update knockout model in js file, why it doesnt update front-end as well?
                    isn't it possible? learn more about knockout?
                    <br />
                    . is it possible to retrieve only the changes from the server? usedSquares method
                    <br />
                    . add samples for different sizes - 4 + 9 (OK) + 16 + 25? + wrong cases; invalid
                    sudoku, invalid number, invalid square, invalid assignment!
                    <br />
                    . on first application load, it fails to retrieve the sudoku!
                    <br />
                    . try to remove Container classes!
                    <br />
                    . unit test projects!
                    <br />
                    . firefox shows an error in case of 400 ?! is it normal
                    <br />
                    . step counter ?!
                    <br />
                    . multiple language support
                    <br />
                    . save to db?
                    <br />
                    . sudoku generator?
                    <br />
                    . test with all browsers + mobile!
                    <br />
                    . clean up; css etc. + check TODO in general!
                    <br />
                    . live default.html + main.js files are different! - urls dont start with "/" -
                    THIS IS OKAY ?!
                </div>
                <br />
                <br />
            </div>
            <div id="listPanel">
                <strong>Sudoku List</strong>
                <div data-bind="foreach: listModel.SudokuList">
                    <div class="sudokuItem">
                        <a data-bind="click: $parent.loadSudoku" href="#">
                            <span data-bind="text: 'Id: ' + SudokuId"></span>
                        </a>
                    </div>
                </div>
                <a data-bind="click: newSudoku" href="#">New sudoku</a>
                <a data-bind="click: resetList" href="#">Reset list</a>
            </div>
        </div>
        <div id="contentRight" class="contentRight">
            <div id="detailsPanel">
                <strong>Details</strong>
                <br />
                Sudoku Id: <span data-bind=" text: SudokuId"></span>
                <br />
                Squares left: <span data-bind=" text: SquaresLeft"></span>
                <br />
                Ready: <a id="toggleReady" data-bind="click: ToggleReady" href="#">
                        <span data-bind="text: ReadyFormatted"></span>
                       </a>
                <br />
                <div id="solvePanel" data-bind="visible: Ready">
                    Autosolve:
                    <a id="toggleAutoSolve" data-bind="click: ToggleAutoSolve" href="#">
                        <span data-bind="text: AutoSolveFormatted"></span>
                    </a>
                    <div class="solve" data-bind="visible: !AutoSolve()">
                        <span>- </span>
                        <a data-bind="click: Solve" href="#">Solve now</a>
                    </div>
                </div>
                <div id="displayOptionsPanel">
                    Display:
                    <a data-bind="click: ToggleDisplayOptions" href="#">
                        <span data-bind="text: DisplayOptionsFormatted"></span>
                    </a>
                </div>
            </div>
            <div id="legendPanel">
                <strong>Legend</strong>
                <br />
                <span class="initial">Initial</span>
                <br />
                <span class="user">User</span>
                <br />
                <span class="solver">Solver</span>
            </div>
            <div id="messagePanel">
                <a id="messagePanelClear" href="#">close</a><span id="messagePanelMessage"></span>
            </div>
            <div id="numbersPanel">
                <strong>Numbers (Counts)</strong>
                <br />
                <div class="numberGroupContainer" data-bind="foreach: numbersModel.NumberGroups">
                    <div class="numberGroup" data-bind="foreach: Numbers">
                        <div class="numberItem">
                            <span class="value" data-bind="text: Value"></span>
                            <span class="count" data-bind="text: '(' + Count + ')'"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="mainGridPanel" data-bind="foreach: gridModel.Groups">
                <div class="groupItem" data-bind="foreach: Squares">
                    <div data-bind="event: { mouseenter: ToggleSelect, mouseleave: ToggleSelect }, css: { initial: AssignType() == 0, user: AssignType() == 1, solver: AssignType() == 2, selected: IsSelected() }" class="squareItem">
                        <span data-bind="text: SquareId" class="squareId"></span>
                        <input data-bind="value: NumberFormatted" class="squareValue" />
                    </div>
                </div>
            </div>
            <div id="availabilityGridPanel" data-bind="foreach: gridModel.Groups">
                <div class="groupItem" data-bind="foreach: Squares">
                    <div data-bind="event: { mouseenter: ToggleSelect, mouseleave: ToggleSelect }, css: { initial: AssignType() == 0, user: AssignType() == 1, solver: AssignType() == 2, selected: IsSelected() }" class="squareItem">
                        <div data-bind="foreach: Availabilities">
                            <div data-bind="css: { unavailable: !IsAvailable() }" class="availabilityItem">
                                <span data-bind="text: Value"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="potentialsPanel">
                <strong>Potentials</strong>
                <br />
                <div data-bind="foreach: potentialsModel.Potentials">
                    <div class="potentialItem" data-bind="event: { mouseenter: ToggleSelect, mouseleave: ToggleSelect }, css: { selected: IsSelected() }">
                        <span data-bind="text: 'SquareId: ' + SquareId + ' - PotentialValue: ' + PotentialValue + ' - PotentialType: ' + PotentialType">
                        </span>
                    </div>
                </div>
            </div>
            <div id="debugPanel"></div>
        </div>
    </div>
</body>
</html>
<script src="Scripts/SudokuSolver/main.js" type="text/javascript"></script>
<script type="text/javascript">

    $(function () {

        //TODO "var" keyword can't be used, "var [x]model" doesn't work, why ?!

        listModel = new ListModel();
        detailsModel = new DetailsModel();
        gridModel = new GridModel();
        numbersModel = new NumbersModel();
        potentialsModel = new PotentialsModel();

        ko.applyBindings(listModel, document.getElementById("listPanel"));
        ko.applyBindings(detailsModel, document.getElementById("detailsPanel"));
        ko.applyBindings(numbersModel, document.getElementById("numbersPanel"));
        ko.applyBindings(gridModel, document.getElementById("mainGridPanel"));
        ko.applyBindings(gridModel, document.getElementById("availabilityGridPanel"));
        ko.applyBindings(potentialsModel, document.getElementById("potentialsPanel"));

        //Load the app
        loadSudokuList();

    });

</script>
